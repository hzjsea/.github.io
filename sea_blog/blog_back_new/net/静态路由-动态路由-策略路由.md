---
title: 静态路由-动态路由-策略路由
categories:
  - 网络
tags:
  - 网络
abbrlink: a1920d83
date: 2020-05-15 01:08:07
---


<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [静态路由-动态路由-策略路由](#静态路由-动态路由-策略路由)
  - [路由表与转发信息库FIB](#路由表与转发信息库fib)
  - [静态路由](#静态路由)
    - [策略路由](#策略路由)
    - [默认路由](#默认路由)
  - [直连路由](#直连路由)
  - [动态路由](#动态路由)
    - [优点与缺点](#优点与缺点)
  - [路由优先级](#路由优先级)
  - [多种路由走向](#多种路由走向)
  - [交换机](#交换机)
    - [静态路由](#静态路由-1)

<!-- /code_chunk_output -->


<!-- more -->

#  静态路由-动态路由-策略路由

![2020-05-15-10-54-35](http://noback.upyun.com/2020-05-15-10-54-35.png)


## 路由表与转发信息库FIB
每个路由器中都至少保存着一张路由表和一张FIB表。
路由器通过路由表选择路由，把优选路由下发到FIB（Forwarding Information Base，转发信息库）表中，通过FIB表指导报文转发

FIB表中每条转发项都指明了要到达某子网或某主机的报文应通过路由器的哪个物理接口发送，就可到达该路径的下一个路由器，或者不需再经过别的路由器便可传送到直接相连的网络中的目的主机。

## 静态路由
顾名思义，就是固定的路由，由用户定好路由，具体包走具体的路
缺点:适用于拓扑结构简单并且稳定的小型网络。其缺点是每当网络拓扑结构发生变化，都需要手工重新配置，不能自动适应。

### 策略路由
它只不过是一种复杂的静态路由，可以基于数据包源地址包头中的其他域向指定下一跳路由器转发数据包。普通的静态路由（也包括动态路由）是按照数据包的目的地址来进行路由，而策略路由还可以连接到扩展IP访问列表，也可以基于协议类型和端口号进行路由选择

### 默认路由
默认路由是一种特殊的静态路由，指的是当路由表中与包的目的地址之间没有匹配的表项时路由器能够做出的选择。 默认路由在某些时候非常有效,当存在末梢网络（也叫末端网络或存根网络，一般指只有一个出口的网络）时，使用一条默认路由就可以完成路由器的配置,减轻管理员的工作负担,提高网络性能!也被称作是缺省路由路由表缺省情况下的路由或者叫做默认网关

## 直连路由
<font color='red'>直连路由是什么</font>
直连路由是连接的直接路由，优先级是最高的，直连路由在链路层被发现



## 动态路由
由协议发现路由
动态路由是与静态路由相对的一个概念，指路由器能够根据路由器之间的交换的特定路由信息自动地建立自己的路由表，并且能够根据链路和节点的变化适时地进行自动调整。当网络中节点或节点间的链路发生故障，或存在其它可用路由时，动态路由可以自行选择最佳的可用路由并继续转发报文。常见的动态路由协议有：RIP、OSPF、IS-IS、BGP、IGRP/EIGRP。每种路由协议的工作方式、选路原则等都有所不同

### 优点与缺点
动态路由可以自动寻找最优的路径，邻居路由也可以通过学习来获得路由表，但是动态路由占用，线路带宽和CPU处理时间。 静态路由是不需要CPU处理时间同样也不占用线路带宽，但是这个路由需要对终端的PC机进行配置网关来实现，工作量是比较大的。



## 路由优先级
策略路由比路由表优先，路由器会先匹配策略路由， <font color='blue'>因此在交换机中，策略路由被放在vlan1</font> 所有的数据包进入交换机后，会先进入vlan1中匹配路由，vlan1作为入口可以设定多组策略路由提供匹配 如果匹配上了就直接按照路由策略转发，如果匹配不上才会看路由表；不过策略路由里的命令也有优先的区分，比如set ip next-hop x.x.x.x比路由表的
优先（如果匹配上了，直接按照此策略转发，不看路由表），而set ip default next-hop x.x.x.x比路由表的优先级低（如果路由表里没有对应的路由，则按照此策略转发）

默认情况下在路由表中直连路由优先级最高，静态路由优先级其次，下来为动态路由，默认路由最低，如果没有默认路由，那么目的地址在路由表中没有匹配表项的包将被丢弃。


## 多种路由走向
在同一台路由器上如果配置了策略、静态、动态、默认四种路由，路由器接口首先对入站的数据包源地址进行判断有没有匹配在此接口上配置的策略路由的数据流，如果有，则按照策略路由的配置转发数据包。如果没有，则按普通数据包情况路由。具体是静态路由协议优先还是动态路由协议优先（去往同一个目的地址根据路由协议的不同有多条路径），要看你在此路由器上定义的管理具体大小，管理距离越小则此种路由协议的可信度越高，则优先选用该种路由协议。而管理距离的默认值又根据各厂家路由器的不同而不同。如果路由表中的条目都没有匹配则按照默认路由转发。



## 交换机
查看交换机的路由表 `dis ip routing-table`

![2020-05-15-11-12-14](http://noback.upyun.com/2020-05-15-11-12-14.png)

### 静态路由
如果静态路由中指定的下一跳地址被配置为本地接口的IP地址，那么静态路由不会生效