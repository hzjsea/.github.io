---
title: 机房割接流程以及事项回溯
categories:
  - 网络
tags:
  - 网络
abbrlink: 45db7e70
date: 2020-05-01 13:22:08
---


<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [机房割接流程以及事项准备](#机房割接流程以及事项准备)
  - [前期准备](#前期准备)
    - [前期割接内容规划](#前期割接内容规划)
  - [割接流程](#割接流程)
  - [后期检测](#后期检测)

<!-- /code_chunk_output -->

<!-- more -->



# 机房割接流程以及事项准备
以2020-05-01 00:00:00 三墩SAD1扩容160G为例子

## 前期准备

### 前期割接内容规划
1. 确定割接内容
当前项目环境主要为一下，B21 A21两个机柜扩容到160G,
![A21,B21-B17](http://noback.upyun.com/2020-05-01-13-38-24.png)
![2020-05-01-13-51-55](http://noback.upyun.com/2020-05-01-13-51-55.png)

2. 机房准备
- 提前几天先通知机房，如果需要跨柜的，量好机柜与机柜之间的距离，准备好跳纤
- 如果需要跨柜，提前一两天将长度足够长的跳纤带到机房，先让机房的人把跳纤弄好，不然到时候一起弄得话。一个是时间上来不及，手忙脚乱的，另一个是如果长度不够，割接就无法继续下去了
- 当天通知机房割接时间，时间提前半小时，做好割接时的准备工作，比如
    - 门口保安，当天去的时候，门口保安睡着了，然后门是关着的，叫不醒，后面是通知了机房的人下来才进去的，下次要提前通知到

3. 流量处理
割接的时候需要把当前交换机上的流量先调到其他交换机上去，需要业务运维配合
- 流量来源
昨天割接的时候，有一大部分时间是在等流量降下来，其中有一部分流量找不到来源，不知道来源就切不掉，不清楚来源的流量又无法直接断掉，所以中间耽搁了一点时间
- 控制台问题
有一部分流量处理的时候，控制台挂掉了，没办法继续操作，业务只能打电话给开发恢复控制台后继续操作
- 流量问题
割接的时候流量尽量要控制到最小，比如最后我们控制到了out上有700M的流量，登了20来分钟，不能操作，后面发现是upssh的流量，才敢进行割接

4. 割接方准备
- 串口线
防止交换机挂了上不去
- 标签机
需要打标签记录的地方,可以用到

## 割接流程
1. 提早到机房
2. 等流量降下来，降到最低，最后的剩下的那一点流量也最好查出来源，不影响就可以进行割接
3. 割接之前确定好操作 https://tower.im/teams/111187/todos/74023/
4. 断掉后，进行操作

## 后期检测
1. 割接完成后，通知业务运维恢复流量，也就是把之前切走的流量一部分一部分的切回来
2. 流量切回的过程中，查看有无报警行为，有无丢包行为
    - 对应行为做对应处理
    - 丢包行为有时候拔插一下线或许可以解决